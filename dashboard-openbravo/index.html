<html>
    <head>
        <script src="../js/js/jquery.js"></script>
        <script src="../js/js/highcharts.js"></script>
        <script src="../js/js/highcharts-more.js"></script>
        <script src="../js/js/modules/exporting.js"></script>

        <script type='text/javascript' src='https://www.google.com/jsapi'></script>
        <script>

        var topleft_progress = new Array();
        var topleft_budget = new Array();
        var topleft_payment_plan = new Array();
        var topleft_x = new Array();

        var project;
        var budgetTopLeft;

        var topright_totalbudget = new Array();
        var topright_budgetplan = new Array();
        var topright_totalpayment = new Array();
        var topright_paymentplan = new Array();
        var topright_x = new Array();

        var budgetTopRight;
        var budgetMiddleLeft;
        var budgetBottomLeft1;
        var budgetBottomRight2



        $.getJSON('http://localhost/topleft.php?callback=?',function(result){
            for (var i in result['databudget']){
                topleft_budget.push(result['databudget'][i]);
            };
            for (var i in result['datax']){
                topleft_x.push(result['datax'][i]);
            };
            for (var i in result['progress']){
                topleft_progress.push(result['progress'][i]);
            };
            for (var i in result['payment_plan']){
                topleft_payment_plan.push(result['payment_plan'][i]);
            };
        });


        $.getJSON("http://localhost/topright.php?callback=?",function(result){
            for (var i in result['totalbudget']){
                topright_totalbudget.push(result['totalbudget'][i]);
            };
            for (var i in result['budgetplan']){
                topright_budgetplan.push(result['budgetplan'][i]);
            };
            for (var i in result['totalpayment']){
                topright_totalpayment.push(result['totalpayment'][i]);
            };
            for (var i in result['paymentplan']){
                topright_paymentplan.push(result['paymentplan'][i]);
            };
            for (var i in result['datax']){
                topright_x.push(result['datax'][i]);
            };
        });

            var demo_tasks;
            $.getJSON("http://localhost/gantt.php?callback=?",function(result){              
                demo_tasks = result;
            });

        function topleft(){
            $('#top-left').highcharts({
                 colors: [
                   '#4572A7', 
                   '#B5CA92',
                   '#DB843D', 
                   '#AA4643', 
                   '#89A54E', 
                   '#80699B', 
                   '#3D96AE', 
                   '#92A8CD', 
                   '#A47D7C' 
                ],
                chart: {
                    zoomType: 'xy'
                },
                title: {
                    text: 'Graph of Budget, Progress & Payment'
                },
                subtitle: {
                    text: 'contains data about budget, projects progress and projects payments'
                },
                xAxis: [{                    
                    categories: topleft_x
                }],
                yAxis: [{ // Primary yAxis
                    labels: {
                        formatter: function() {
                            return this.value +'%';
                        },
                        style: {
                            color: '#89A54E'
                        }
                    },
                    title: {
                        text: 'Persentase',
                        style: {
                            color: '#89A54E'
                        }
                    },
                    opposite: false
        
                }],
                tooltip: {
                    shared: true
                },
                legend: {
                    layout: 'vertical',
                    align: 'left',
                    x: 120,
                    verticalAlign: 'top',
                    y: 80,
                    floating: true,
                    backgroundColor: '#dedede'
                },
                series: [{
                    name: 'Progress',
                    //color: '#AA4643',
                    type: 'spline',
                    yAxis: 0,
                    index: 2,
                    data:topleft_progress,
                    tooltip: {
                        valueSuffix: ' %'
                    }
        
                }, {
                    name: 'Budget',
                    type: 'column',
                    dataLabels: { enabled: true },
                    //color: '#95D2F7',
                    yAxis: 0,
                    index: 1,
                    data:topleft_budget,
                    marker: {
                        enabled: false
                    },
                    dashStyle: 'shortdot',
                    tooltip: {
                        valueSuffix: ' %'
                    }
        
                }, {
                    name: 'Payment Plan',
                    //color: '#89A54E',
                    type: 'spline',
                    index: 3,
                    data: topleft_payment_plan,
                    tooltip: {
                        valueSuffix: ' %'
                    }
                }]
            });
        }

        function toprightGraph(){
            $('#top-right').highcharts({
                colors: [
                   '#4572A7', 
                   '#80699B', 
                   '#89A54E', 
                   '#DB843D', 
                   '#92A8CD', 
                   '#3D96AE',
                   '#AA4643', 
                   '#A47D7C', 
                   '#B5CA92'
                ],
                plotOptions: {
                    column: {
                        pointPadding: 0.01,
                        borderWidth: 0
                    }
                },
                chart: {
                    zoomType: 'xy'
                },
                title: {
                    text: 'Graph of Budget and Cashflow'
                },
                subtitle: {
                    text: 'contains data about budget and cashflow '
                },
                xAxis: [{
                    categories: topright_x
                }],
                yAxis: [{ // Primary yAxis
                    labels: {
                        formatter: function() {
                            return 'Rp. ' + this.value + ' (Billion)';
                        },
                        style: {
                            color: '#89A54E'
                        }
                    },
                    title: {
                        text: 'Rupiah',
                        style: {
                            color: '#89A54E'
                        }
                    },
                    opposite: false
        
                }],
                tooltip: {
                    shared: true
                },
                legend: {
                    layout: 'vertical',
                    align: 'left',
                    x: 120,
                    verticalAlign: 'top',
                    y: 80,
                    floating: true,
                    backgroundColor: '#dedede'
                },                
                series: [{
                    name: 'Total Budget',
                    type: 'spline',
                    yAxis: 0,
                    index: 2,
                    dashStyle: 'ShortDash',
                    marker: {
                        enabled: false
                    },
                    data: topright_totalbudget,
                    tooltip: {
                        valueSuffix: ' Billion',
                        valuePrefix: 'Rp. '
                    }
        
                }, {
                    name: 'Budget Plan',
                    type: 'column',
                    dataLabels: {
                        enabled: true
                    },
                    yAxis: 0,
                    index: 1,
                    data: topright_budgetplan,
                    
                    tooltip: {
                        valueSuffix: ' Billion',
                        valuePrefix: 'Rp. '
                    }
        
                }, {
                    name: 'Total Payment',
                    type: 'spline',
                    index: 3,
                    dashStyle: 'ShortDash',
                    marker: {
                        enabled: false
                    },
                    data: topright_totalpayment,
                    tooltip: {
                        valueSuffix: ' Billion',
                        valuePrefix: 'Rp. '
                    }
                } , {
                    name: 'Payment Plan',
                    type: 'column',
                    dataLabels: {
                        enabled: true
                    },
                    yAxis: 0,
                    index: 1,
                    data: topright_paymentplan,
                    marker: {
                        enabled: false
                    },
                    tooltip: {
                        valueSuffix: ' Billion',
                        valuePrefix: 'Rp. '
                    }
        
                }]
            });
        }

        $(function () {
            topleft();
            toprightGraph();
        });

        </script>
       
        <script>      
            // google.load('visualization', '1', {packages:['timeline','table']});
            // google.setOnLoadCallback(drawChart);
            // function drawChart() {
            
            //     var container = document.getElementById('bottom-left');
            //     var chart = new google.visualization.Timeline(container);
            
            //     var dataTable = new google.visualization.DataTable();
            //     dataTable.addColumn({ type: 'string', id: 'Item' });
            //     dataTable.addColumn({ type: 'string', id: 'Name' });
            //     dataTable.addColumn({ type: 'date', id: 'Start' });
            //     dataTable.addColumn({ type: 'date', id: 'End' });
            //     dataTable.addRows([
            //         [ 'CIBIS Tower 1','', new Date(2013, 1, 1), new Date(2015,1, 1)],
            //         [ 'CIBIS Tower 2',' ', new Date(2014, 1, 1), new Date(2016,1, 1)],
            //         [ 'CIBIS Tower 3','  ', new Date(2015, 1, 1), new Date(2016,6, 1)]
            //     ]);
            
            //     var options = {
            //         timeline: { groupByRowLabel: false }
            //     };
                
            //     chart.draw(dataTable,options);
                
            // }
            
        </script>

        <script>
            var rows_mid = new Array();
            $.getJSON('http://localhost/middleleft.php?callback=?',function(result){
                for (var i in result){
                    var rows1 = [];
                    rows1[0] = result[i][0];
                    rows1[1] = result[i][1]; 
                    rows1[2] = result[i][2]; 
                    rows1[3] = result[i][3]; 
                    rows1[4] = result[i][4]; 
                    rows1[5] = result[i][5]; 
                    rows_mid.push(rows1);
                };
            }); 

            google.load('visualization', '1', {packages:['table']});
            google.setOnLoadCallback(drawTable1);
            function drawTable1() {
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Phase');
                data.addColumn('number', 'Budget 1');
                data.addColumn('number', '2013');
                data.addColumn('number', '2014');
                data.addColumn('number', '2015');
                data.addColumn('number', 'Balance');
                data.addRows(rows_mid);

                var table = new google.visualization.Table(document.getElementById('bottom-right'));
                table.draw(data, {showRowNumber: true});
            }
            </script>

            <script type="text/javascript">
                var rows_bottom = new Array();
                $.getJSON("http://localhost/bottomleft.php?callback=?",function(result){
                     for (var i in result){
                        var rows2 = [];
                        rows2[0] = result[i][0];
                        rows2[1] = result[i][1];
                        rows2[2] = result[i][2];
                        rows2[3] = result[i][3];
                        rows_bottom.push(rows2);
                     };
                 });


                google.load('visualization', '1', {packages:['table']});
                google.setOnLoadCallback(drawTable2);
                function drawTable2(){
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Phase');
                    data.addColumn('number', 'Budget A');
                    data.addColumn('number', 'Budget B');
                    data.addColumn('number', 'Variance');
                    data.addRows(rows_bottom);

                    var table = new google.visualization.Table(document.getElementById('bottom-right2'));
                    table.draw(data, {showRowNumber: true});
                }
            </script>

        
    </head>

    <body cellspacing='5'>
        <script src="../js/codebase/dhtmlxgantt.js" type="text/javascript" charset="utf-8"></script>
        <script src="../js/codebase/ext/dhtmlxgantt_quick_info.js" type="text/javascript" charset="utf-8"></script>

        <link rel="stylesheet" href="../js/codebase/dhtmlxgantt.css" type="text/css" media="screen" title="no title" charset="utf-8">
<!-- 
        <script type="text/javascript" src="../js/common/testdata.js"></script>
         -->
        <!-- SCRIPT -->
        <script type="text/javascript">
        </script>

        <div id="top" style='height:48%;'>
        <!-- TOP LEFT -->
            <span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e; float:left">Select Budget:</span> 
            <select id='optBudgetTopLeft'>        </select>
            <input type='button' value='Apply' id='btnTopLeftBudget'></input>
            </br>

            <span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e; float:left">Select Project:</span>
            <select id='optProjectTopLeft'>       </select>
            <input type='button' value='Apply' id='btnTopLeftProject' style="display:none"></input>
            </br>

        <div id="top-left" style='width:50%; float:left'></div>
        <!-- TOP LEFT -->

        <!-- TOP RIGHT -->
        <span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e; float:left">Select Budget:</span> <select id='optBudgetTopRight'>
                    <option>Budget 1</option>
                    <option>Budget 2</option>
                </select>
                <input type='button' value='Apply' id='btnTopRight'></input>
        <div id="top-right" style='width:50%; float:right'></div>
        <!-- TOP RIGHT -->

        </div>
        <div id="bottom" style='height:48%;'>
            <br />

            <div id="bottom-left-header" style='width:48%; float:right'>
                <center>
                <text x="333" y="25" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:16px;color:#274b6d;fill:#274b6d;" text-anchor="middle" class="highcharts-title" zIndex="4"><tspan x="333">Gantt Chart Project</tspan></text><br />
                <text x="333" y="40" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e;" text-anchor="middle" class="highcharts-subtitle" zIndex="4"><tspan x="333">contains project timeline</tspan></text>
                </center>
                <br />
                <div id="bottom-left1" style='width:100%;'></div>
                <div id="gantt_here" style='width:100%; height:85%;'></div>
                <script type="text/javascript">
                    gantt.config.readonly = true;
                    gantt.config.drag_progress = false;
                    gantt.init("gantt_here");
                    gantt.parse(demo_tasks);
                </script>
            </div>

            <div id="bottom-right-header" style='width:48%; float:left'>
                <center>
                <text x="333" y="25" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:16px;color:#274b6d;fill:#274b6d;" text-anchor="middle" class="highcharts-title" zIndex="4"><tspan x="333">Budget vs Cost Table</tspan></text><br />
                <text x="333" y="40" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e;" text-anchor="middle" class="highcharts-subtitle" zIndex="4"><tspan x="333">contains budget vs cost yearly</tspan></text>
                </center>
                <span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e;">Select Budget:</span> <select id='budgetMiddleLeft'>
                    <option>Budget v5</option>
                    <option>Budget v4</option>
                </select>
                <input type='button' value='Apply' id='btnMiddleLeft'></input>
                <br />
                <br />
                <div id="bottom-right" style='width:100%;'>

                </div>
            </div>  
            
            <div id="bottom-right-header2" style='width:48%; float:left'>
                <br /><br />
                <center>
                <text x="333" y="25" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:16px;color:#274b6d;fill:#274b6d;" text-anchor="middle" class="highcharts-title" zIndex="4"><tspan x="333">Budget Comparison</tspan></text><br />
                <text x="333" y="40" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e;" text-anchor="middle" class="highcharts-subtitle" zIndex="4"><tspan x="333">contains comparison between budget</tspan></text>
                </center>
                <span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e;">First Budget:</span> <select id='budgetBottomRight1'>
                    <option>Budget v5</option>
                    <option>Budget v4</option>
                </select>
                <span style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Verdana, Arial, Helvetica, sans-serif;font-size:12px;color:#4d759e;fill:#4d759e;">Second Budget:</span> <select id='budgetBottomRight2'>
                    <option>Budget v5</option>
                    <option>Budget v4</option>
                </select>
                <input type='button' value='Apply' id='btnBottomLeft'></input>
                <br />
                <br />
                <div id="bottom-right2" style='width:100%;'></div>
                <br />

            </div>
        </div> 

<script type="text/javascript">
            $.getJSON("http://localhost/getbudget.php?callback=?",function(j){
                var options = '';
                options += '<option value="">All</option>';
                for (var i = 0; i < j.length; i++) {
                    options += '<option value="' + j[i].c_budget_id + '">' + j[i].name + '</option>';
                }
                $("select#optBudgetTopLeft").html(options);

                var options = '';
                for (var i = 0; i < j.length; i++) {
                    options += '<option value="' + j[i].c_budget_id + '">' + j[i].name + '</option>';
                }

                $("select#optBudgetTopRight").html(options);
                $("select#budgetMiddleLeft").html(options);
                $("select#budgetBottomRight1").html(options);
                $("select#budgetBottomRight2").html(options);
                budgetTopLeft = $("#optBudgetTopLeft" ).val();
                budgetTopRight = $("#optBudgetTopRight" ).val();
                budgetMiddleLeft = $("#budgetMiddleLeft" ).val();
                budgetBottomRight1 = $("#budgetBottomRight1" ).val();
                budgetBottomRight2 = $("#budgetBottomRight2" ).val();
            });

            $.getJSON("http://localhost/getproject.php?callback=?",function(j){
                var options = '';
                options += '<option value="">All Project</option>';
                for (var i = 0; i < j.length; i++) {
                    options += '<option value="' + j[i].c_project_id + '">' + j[i].name + '</option>';
                }
                $("select#optProjectTopLeft").html(options);
                project = $("#optProjectTopLeft" ).val();
            });

            $("#btnTopLeftBudget").click(function(){
                topleft_progress.length = 0;
                topleft_budget.length = 0;
                topleft_x.length = 0;
                topleft_payment_plan.length = 0;

                $.getJSON('http://localhost/topleft.php?callback=?','project='+project+'&budget=' +budgetTopLeft,function(result){
                    for (var i in result['databudget']){
                        topleft_budget.push(result['databudget'][i]);
                    };
                    for (var i in result['datax']){
                        topleft_x.push(result['datax'][i]);
                    };
                    for (var i in result['progress']){
                        topleft_progress.push(result['progress'][i]);
                    };
                    for (var i in result['payment_plan']){
                        topleft_payment_plan.push(result['payment_plan'][i]);
                    };
                    topleft();
                });
            });

            $("#btnTopRight").click(function(){
                topright_totalbudget.length = 0;
                topright_budgetplan.length = 0;
                topright_totalpayment.length = 0;
                topright_paymentplan.length = 0;
                topright_x.length = 0;

                $.getJSON("http://localhost/topright.php?callback=?",'budget='+budgetTopRight,function(result){
                    for (var i in result['totalbudget']){
                        topright_totalbudget.push(result['totalbudget'][i]);
                    };
                    for (var i in result['budgetplan']){
                        topright_budgetplan.push(result['budgetplan'][i]);
                    };
                    for (var i in result['totalpayment']){
                        topright_totalpayment.push(result['totalpayment'][i]);
                    };
                    for (var i in result['paymentplan']){
                        topright_paymentplan.push(result['paymentplan'][i]);
                    };
                    for (var i in result['datax']){
                        topright_x.push(result['datax'][i]);
                    };
                    toprightGraph();
                });
            });
            
            $("#btnMiddleLeft").click(function(){
                rows_mid.length = 0;
                $.getJSON('http://localhost/middleleft.php?callback=?','budget='+budgetMiddleLeft,function(result){
                    for (var i in result){
                        var rows1 = [];
                        rows1[0] = result[i][0];
                        rows1[1] = result[i][1]; 
                        rows1[2] = result[i][2]; 
                        rows1[3] = result[i][3]; 
                        rows1[4] = result[i][4]; 
                        rows1[5] = result[i][5]; 
                        rows_mid.push(rows1);
                    };
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Phase');
                    data.addColumn('number', 'Budget 1');
                    data.addColumn('number', '2013');
                    data.addColumn('number', '2014');
                    data.addColumn('number', '2015');
                    data.addColumn('number', 'Balance');
                    data.addRows(rows_mid);

                    var table = new google.visualization.Table(document.getElementById('bottom-right'));
                    table.draw(data, {showRowNumber: true});
                }); 
                // google.load('visualization', '1', {packages:['table']});
                // google.setOnLoadCallback(drawTable1);
                // drawTable1();
                // alert(rows_mid);
            });

            $("#btnBottomLeft").click(function(){
                rows_bottom.length = 0;
                $.getJSON("http://localhost/bottomleft.php?callback=?","budget1="+budgetBottomRight1+"&budget2="+budgetBottomRight2,function(result){
                     for (var i in result){
                        var rows2 = [];
                        rows2[0] = result[i][0];
                        rows2[1] = result[i][1];
                        rows2[2] = result[i][2];
                        rows2[3] = result[i][3];
                        rows_bottom.push(rows2);
                     };
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'Phase');
                    data.addColumn('number', result[i][4]);
                    data.addColumn('number', result[i][5]);
                    data.addColumn('number', 'Variance');
                    data.addRows(rows_bottom);

                    var table = new google.visualization.Table(document.getElementById('bottom-right2'));
                    table.draw(data, {showRowNumber: true});
                 });
                // google.load('visualization', '1', {packages:['table']});
                // google.setOnLoadCallback(drawTable2);
            });

            $("#optBudgetTopLeft" ).change(function() {
              budgetTopLeft = $(this).val();
            });

            $("#optProjectTopLeft" ).change(function() {
              project = $(this).val();
            });

            $("#optBudgetTopRight" ).change(function() {
              budgetTopRight = $(this).val();
            });

            $("#budgetMiddleLeft" ).change(function() {
              budgetMiddleLeft = $(this).val();
            });

            $("#budgetBottomRight1" ).change(function() {
              budgetBottomRight1 = $(this).val();
            });

            $("#budgetBottomRight2" ).change(function() {
              budgetBottomRight2 = $(this).val();
            });
        </script>
        
    </body>
</html>